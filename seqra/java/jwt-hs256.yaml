rules:
- id: jjwt-hs256
  message: >-
    'HS256' algorithm can be bruteforced, and thus is considered insecure
    in a JWT token.
  metadata:
    shortDescription: Risky Cryptographic Algorithm for a JWT token.
    cwe:
    - 'CWE-327: Use of a Broken or Risky Cryptographic Algorithm'
    category: security
    technology:
    - jwt
    confidence: LOW
    likelihood: LOW
    impact: MEDIUM
  languages: [java]
  severity: WARNING
  mode: taint
  pattern-sources:
    - pattern: $JWTS = io.jsonwebtoken.Jwts.builder();
  pattern-propagators:
    - pattern: $MODIFIED = $ORIGINAL.$MD(...);
      from: $ORIGINAL
      to: $MODIFIED
  pattern-sinks:
    - pattern: $JWTS.signWith(SignatureAlgorithm.HS256, ...);
