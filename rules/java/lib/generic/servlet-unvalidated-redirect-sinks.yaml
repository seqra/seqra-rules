rules:
  - id: java-servlet-unvalidated-redirect-sinks
    options:
      lib: true
    severity: NOTE
    message: Potential redirect to an untrusted URL
    metadata:
      provenance: https://gitlab.com/gitlab-org/security-products/sast-rules/-/blob/main/java/endpoint/rule-UnvalidatedRedirect.yml
    languages:
      - java
    mode: taint
    pattern-sinks:
      - pattern: (HttpServletResponse $RES).sendRedirect($URL);
      - pattern: (HttpServletResponse $RES).addHeader("Location", $URL);
    pattern-sanitizers:
      - patterns:
        - pattern: $URL = (HttpServletRequest $REQ).getContextPath();
        - focus-metavariable: $URL
